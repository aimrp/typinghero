# BACKEND_STRUCTURE - 后端结构与数据规划

本项目当前阶段是「纯前端 + 本地桌面应用」，**尚未接入任何远程后端服务或数据库**。本文件的作用是：

- 明确当前「没有后端」的事实，避免 AI / 协作者臆想出 API；
- 为未来如果要扩展「云同步 / 账号系统 / 云端题库」时预留一个统一的设计入口。

## 1. 当前状态（无后端）

### 1.1 运行特性

- 所有数据均在本地内存中维护：
  - 当前目标文本（诗句）；
  - 当前 Combo、WPM、准确率；
  - 本局统计数据（完成句数、平均 WPM 等）。
- 应用关闭后，这些数据不做持久化保存（目前）。
- 素材（诗词）直接硬编码在 keyboard.html 中的数组中。

### 1.2 没有的东西（很重要）

- 没有 HTTP 接口；
- 没有 WebSocket 通信；
- 没有远程数据库（MySQL / PostgreSQL / MongoDB 等）；
- 没有云端账号体系；
- 没有「云同步」、「排行榜」、「多人对战」等功能。

> 如果后续在代码中引入任何「fetch / axios / WebSocket」等后端通信，必须先在本文件中更新设计并说明用途。

## 2. 未来可能的后端演进方向

> 以下内容是为了方便未来扩展，不代表当前一定要做。

### 2.1 本地持久化（轻量级）

目标：在不引入真正后端的前提下，做一些「本机层面」的增强。

可选方案：

- 使用 Electron 提供的 **文件系统 API** 或 Node.js `fs`：
  - 在用户目录下保存一个 JSON 文件，记录练习历史、最高连击等；
  - 启动应用时读取，关闭时写回。
- 使用浏览器内建能力（如果未来有 Web 版）：
  - `localStorage` / `IndexedDB` 存储简单统计数据。

### 2.2 远程题库 / 在线内容更新

如果未来希望动态更新诗词库，或者从服务器拉取新的素材，可以考虑：

- 提供一个只读 API，例如：
  - `GET /api/poems/random` 返回一条待练习的诗句；
  - `GET /api/poems/list` 返回当前可选题库列表。
- 后端可以是任意栈（如 Node.js + PostgreSQL），此处不强制约定，只需要：
  - API 响应格式稳定；
  - 对前端保持向后兼容。

### 2.3 账号与云同步

如果将来需要支持「登录」、「多设备同步」：

- 需要新增：
  - 用户表（user）；
  - 成绩记录表（stats）；
  - 练习会话表（session）等。
- 考虑的功能包括：
  - 不同设备之间同步最高分、练习记录；
  - 教师查看学生的练习情况。

> 一旦决定做云同步，需要在本文件中补充具体的数据表结构和接口定义，并在 PRD 中增加相应的产品需求。

## 3. 数据建模占位（当前不实施）

以下是一个「示例级」的数据建模草案，仅作为未来扩展的起点，不在当前版本实现：

### 3.1 样例表：poem（诗词）

- `id`: 主键
- `text`: 完整诗句文本
- `source`: 来源（如《唐诗三百首》）
- `grade`: 年级 / 难度
- `created_at`: 创建时间

### 3.2 样例表：practice_session（练习会话）

- `id`: 主键
- `user_id`: 用户 id（未来有账号系统时使用）
- `started_at`: 开始时间
- `ended_at`: 结束时间
- `total_sentences`: 完成句数
- `avg_wpm`: 平均 WPM
- `avg_accuracy`: 平均准确率
- `max_combo`: 最高连击

> 再次强调：当前代码版本中 **没有任何这类表或后端调用**，这里只是为将来预留文档位置。

## 4. 约束与约定

1. 在未更新本文件之前，不要在代码里随意加入远程后端调用；
2. 若要新增本地持久化方案（文件 / localStorage 等），请在这里补充设计：
   - 存储位置；
   - 数据格式；
   - 读写策略；
   - 隐私和安全考虑；
3. 如果引入真正的后端服务，需要：
   - 在此文件中定义数据库结构与 API 合约；
   - 在 TECH_STACK.md 中记录后端技术栈和版本；
   - 在 PRD 中增加对应的产品需求和用户故事。

